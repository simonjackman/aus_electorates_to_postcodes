<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Simon Jackman">
<meta name="description" content="We derive the correspondence between NSW legislative districts and postcodes via a spatial merge, using the G-NAF and a MapInfo file of district boundaries from the NSW Electoral Commission. We also provide an interactive tabular summary and map of the correspondence.">

<title>NSW 2023 legislative districts to postcodes: correspondence file &amp; mapping application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

<script type="ojs-define">
{"contents":[{"name":"out_raw","value":{"district":["ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","ALBURY","AUBURN","AUBURN","AUBURN","AUBURN","AUBURN","AUBURN","AUBURN","AUBURN","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BADGERYS CREEK","BALLINA","BALLINA","BALLINA","BALLINA","BALLINA","BALLINA","BALLINA","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BALMAIN","BANKSTOWN","BANKSTOWN","BANKSTOWN","BANKSTOWN","BANKSTOWN","BANKSTOWN","BANKSTOWN","BANKSTOWN","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BARWON","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BATHURST","BEGA","BEGA","BEGA","BEGA","BEGA","BEGA","BEGA","BEGA","BEGA","BEGA","BLACKTOWN","BLACKTOWN","BLACKTOWN","BLACKTOWN","BLACKTOWN","BLACKTOWN","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","BLUE MOUNTAINS","CABRAMATTA","CABRAMATTA","CABRAMATTA","CABRAMATTA","CABRAMATTA","CAMDEN","CAMDEN","CAMDEN","CAMDEN","CAMPBELLTOWN","CAMPBELLTOWN","CAMPBELLTOWN","CAMPBELLTOWN","CANTERBURY","CANTERBURY","CANTERBURY","CANTERBURY","CANTERBURY","CANTERBURY","CANTERBURY","CANTERBURY","CASTLE HILL","CASTLE HILL","CASTLE HILL","CASTLE HILL","CASTLE HILL","CASTLE HILL","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CESSNOCK","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CHARLESTOWN","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","CLARENCE","COFFS HARBOUR","COFFS HARBOUR","COFFS HARBOUR","COFFS HARBOUR","COFFS HARBOUR","COOGEE","COOGEE","COOGEE","COOGEE","COOGEE","COOGEE","COOGEE","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","COOTAMUNDRA","CRONULLA","CRONULLA","CRONULLA","CRONULLA","CRONULLA","CRONULLA","DAVIDSON","DAVIDSON","DAVIDSON","DAVIDSON","DAVIDSON","DAVIDSON","DAVIDSON","DAVIDSON","DAVIDSON","DRUMMOYNE","DRUMMOYNE","DRUMMOYNE","DRUMMOYNE","DRUMMOYNE","DRUMMOYNE","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","DUBBO","EAST HILLS","EAST HILLS","EAST HILLS","EAST HILLS","EAST HILLS","EAST HILLS","EAST HILLS","EAST HILLS","EPPING","EPPING","EPPING","EPPING","EPPING","EPPING","EPPING","FAIRFIELD","FAIRFIELD","FAIRFIELD","FAIRFIELD","FAIRFIELD","FAIRFIELD","FAIRFIELD","FAIRFIELD","FAIRFIELD","GOSFORD","GOSFORD","GOSFORD","GOSFORD","GOSFORD","GOSFORD","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GOULBURN","GRANVILLE","GRANVILLE","GRANVILLE","GRANVILLE","GRANVILLE","GRANVILLE","GRANVILLE","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HAWKESBURY","HEATHCOTE","HEATHCOTE","HEATHCOTE","HEATHCOTE","HEATHCOTE","HEATHCOTE","HEATHCOTE","HEFFRON","HEFFRON","HEFFRON","HEFFRON","HEFFRON","HEFFRON","HEFFRON","HEFFRON","HEFFRON","HOLSWORTHY","HOLSWORTHY","HOLSWORTHY","HOLSWORTHY","HOLSWORTHY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","HORNSBY","KEIRA","KEIRA","KEIRA","KEIRA","KEIRA","KEIRA","KEIRA","KEIRA","KELLYVILLE","KELLYVILLE","KELLYVILLE","KELLYVILLE","KIAMA","KIAMA","KIAMA","KIAMA","KIAMA","KIAMA","KIAMA","KIAMA","KIAMA","KIAMA","KOGARAH","KOGARAH","KOGARAH","KOGARAH","KOGARAH","KOGARAH","KOGARAH","KOGARAH","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LAKE MACQUARIE","LANE COVE","LANE COVE","LANE COVE","LANE COVE","LANE COVE","LANE COVE","LANE COVE","LEPPINGTON","LEPPINGTON","LEPPINGTON","LEPPINGTON","LEPPINGTON","LEPPINGTON","LEPPINGTON","LEPPINGTON","LEPPINGTON","LEPPINGTON","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LISMORE","LIVERPOOL","LIVERPOOL","LIVERPOOL","LIVERPOOL","LONDONDERRY","LONDONDERRY","LONDONDERRY","LONDONDERRY","LONDONDERRY","LONDONDERRY","LONDONDERRY","LONDONDERRY","MACQUARIE FIELDS","MACQUARIE FIELDS","MACQUARIE FIELDS","MACQUARIE FIELDS","MACQUARIE FIELDS","MACQUARIE FIELDS","MACQUARIE FIELDS","MACQUARIE FIELDS","MAITLAND","MAITLAND","MAITLAND","MAITLAND","MAITLAND","MAITLAND","MAITLAND","MANLY","MANLY","MANLY","MANLY","MANLY","MANLY","MANLY","MAROUBRA","MAROUBRA","MAROUBRA","MAROUBRA","MAROUBRA","MAROUBRA","MIRANDA","MIRANDA","MIRANDA","MIRANDA","MIRANDA","MIRANDA","MIRANDA","MIRANDA","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MONARO","MOUNT DRUITT","MOUNT DRUITT","MOUNT DRUITT","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MURRAY","MYALL LAKES","MYALL LAKES","MYALL LAKES","MYALL LAKES","MYALL LAKES","MYALL LAKES","MYALL LAKES","MYALL LAKES","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWCASTLE","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NEWTOWN","NORTH SHORE","NORTH SHORE","NORTH SHORE","NORTH SHORE","NORTH SHORE","NORTH SHORE","NORTH SHORE","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","NORTHERN TABLELANDS","OATLEY","OATLEY","OATLEY","OATLEY","OATLEY","OATLEY","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","ORANGE","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","OXLEY","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PARRAMATTA","PENRITH","PENRITH","PENRITH","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PITTWATER","PORT MACQUARIE","PORT MACQUARIE","PORT MACQUARIE","PORT MACQUARIE","PORT MACQUARIE","PORT MACQUARIE","PORT MACQUARIE","PORT MACQUARIE","PORT MACQUARIE","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PORT STEPHENS","PROSPECT","PROSPECT","PROSPECT","PROSPECT","PROSPECT","PROSPECT","PROSPECT","PROSPECT","PROSPECT","RIVERSTONE","RIVERSTONE","RIVERSTONE","RIVERSTONE","RIVERSTONE","RIVERSTONE","ROCKDALE","ROCKDALE","ROCKDALE","ROCKDALE","ROCKDALE","RYDE","RYDE","RYDE","RYDE","RYDE","RYDE","RYDE","SHELLHARBOUR","SHELLHARBOUR","SHELLHARBOUR","SHELLHARBOUR","SOUTH COAST","SOUTH COAST","SOUTH COAST","SOUTH COAST","SOUTH COAST","SOUTH COAST","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","STRATHFIELD","SUMMER HILL","SUMMER HILL","SUMMER HILL","SUMMER HILL","SUMMER HILL","SUMMER HILL","SUMMER HILL","SUMMER HILL","SUMMER HILL","SWANSEA","SWANSEA","SWANSEA","SWANSEA","SWANSEA","SWANSEA","SYDNEY","SYDNEY","SYDNEY","SYDNEY","SYDNEY","SYDNEY","SYDNEY","SYDNEY","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TAMWORTH","TERRIGAL","TERRIGAL","TERRIGAL","TERRIGAL","TERRIGAL","THE ENTRANCE","THE ENTRANCE","THE ENTRANCE","THE ENTRANCE","THE ENTRANCE","TWEED","TWEED","TWEED","TWEED","TWEED","TWEED","TWEED","TWEED","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","UPPER HUNTER","VAUCLUSE","VAUCLUSE","VAUCLUSE","VAUCLUSE","VAUCLUSE","VAUCLUSE","VAUCLUSE","VAUCLUSE","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAGGA WAGGA","WAHROONGA","WAHROONGA","WAHROONGA","WAHROONGA","WAHROONGA","WAHROONGA","WAKEHURST","WAKEHURST","WAKEHURST","WAKEHURST","WAKEHURST","WAKEHURST","WAKEHURST","WAKEHURST","WALLSEND","WALLSEND","WALLSEND","WALLSEND","WALLSEND","WALLSEND","WALLSEND","WALLSEND","WALLSEND","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WILLOUGHBY","WINSTON HILLS","WINSTON HILLS","WINSTON HILLS","WINSTON HILLS","WINSTON HILLS","WINSTON HILLS","WINSTON HILLS","WINSTON HILLS","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONDILLY","WOLLONGONG","WOLLONGONG","WOLLONGONG","WOLLONGONG","WOLLONGONG","WOLLONGONG","WOLLONGONG","WOLLONGONG","WOLLONGONG","WOLLONGONG","WYONG","WYONG","WYONG","WYONG","WYONG",null],"postcode":["2640","2641","2646","2642","2647","2643","2644","2653","2660","2658","2659","2652","2645","2700","3691","2650","2629","3707","2649","2656","2144","2141","2162","2199","2143","2197","2200","2135","2745","2759","2570","2178","2175","2557","2556","2748","2766","2555","2176","2478","2481","2477","2483","2482","2479","2480","2040","2037","2041","2007","2038","2039","2050","2009","2008","2048","2049","2200","2190","2196","2195","2199","2210","2209","2212","2880","2390","2835","2357","2877","2827","2829","2388","2840","2825","2824","2831","2832","2834","2382","2672","2843","2844","2396","2839","2836","2873","2395","2828","2879","2842","2833","2878","2397","2386","2669","2817","2356","2838","2826","2875","2381","2387","2671","2379","2822","2874","2329","2823","2871","2830","2648","2347","2398","2852","2795","2790","2787","2799","2849","2847","2848","2845","2798","2850","2792","2791","2797","2846","2786","2580","2785","2800","2536","2550","2537","2546","2548","2551","2549","2545","2622","2632","2148","2767","2761","2763","2766","2765","2780","2777","2774","2785","2782","2773","2779","2776","2783","2786","2778","2784","2758","2787","2166","2176","2170","2177","2164","2567","2570","2557","2566","2560","2559","2563","2557","2194","2195","2206","2192","2193","2196","2208","2209","2154","2153","2156","2125","2158","2126","2325","2285","2327","2326","2321","2286","2334","2335","2320","2278","2323","2322","2250","2290","2289","2282","2305","2285","2306","2291","2280","2292","2303","2460","2470","2464","2463","2473","2462","2469","2466","2471","2472","2450","2453","2465","2480","2370","2456","2450","2456","2452","2454","2460","2031","2034","2022","2024","2026","2032","2033","2594","2794","2590","2666","2700","2671","2663","2810","2586","2722","2665","2587","2701","2652","2669","2793","2702","2668","2804","2807","2727","2725","2650","2805","2721","2803","2588","2808","2729","2585","2726","2809","2582","2583","2792","2799","2705","2871","2584","2797","2720","2230","2229","2227","2232","2228","2231","2075","2070","2071","2072","2069","2085","2074","2086","2073","2046","2137","2138","2047","2140","2134","2830","2850","2820","2821","2852","2823","2818","2831","2869","2822","2866","2868","2844","2800","2867","2795","2842","2213","2211","2212","2200","2214","2198","2199","2197","2121","2118","2117","2119","2151","2120","2125","2165","2163","2166","2162","2164","2161","2197","2176","2198","2250","2257","2256","2083","2775","2259","2580","2577","2582","2583","2579","2578","2581","2620","2584","2618","2575","2576","2622","2621","2611","2727","2160","2161","2145","2142","2164","2150","2162","2756","2765","2753","2754","2758","2157","2775","2757","2155","2325","2330","2156","2250","2232","2233","2515","2508","2516","2230","2173","2017","2020","2018","2015","2044","2033","2032","2021","2043","2170","2234","2173","2172","2232","2077","2126","2079","2158","2082","2159","2081","2125","2080","2083","2157","2120","2156","2775","2154","2756","2526","2518","2517","2519","2500","2525","2516","2530","2155","2153","2154","2768","2527","2533","2541","2535","2534","2540","2577","2529","2530","2622","2220","2218","2207","2217","2221","2208","2209","2222","2283","2264","2284","2265","2285","2259","2267","2282","2278","2323","2066","2111","2113","2112","2110","2065","2067","2179","2171","2170","2558","2565","2566","2557","2178","2168","2559","2480","2484","2372","2474","2469","2476","2482","2475","2371","2470","2471","4383","2479","4380","2472","4377","2477","4375","2170","2168","2177","2171","2760","2747","2765","2753","2749","2748","2762","2770","2565","2566","2564","2174","2170","2167","2179","2171","2320","2323","2322","2321","2324","2326","2334","2095","2093","2099","2096","2094","2100","2092","2035","2036","2019","2032","2034","2018","2228","2224","2234","2226","2232","2227","2229","2225","2620","2630","2627","2622","2619","2621","2632","2628","2625","2629","2631","2623","2626","2633","2580","2624","2581","2770","2761","2766","2680","2710","2705","2731","2711","2714","2713","2648","2732","2675","3644","2712","2738","2681","2707","2717","2715","2739","2716","2706","2737","2652","2703","2733","2734","2736","2735","2669","2700","2665","2646","2878","2647","2430","2428","2429","2423","2312","2424","2422","2426","2300","2304","2303","2291","2295","2293","2302","2292","2294","2296","2289","2298","2297","2318","2322","2305","2042","2016","2008","2049","2043","2048","2050","2204","2015","2017","2203","2000","2010","2040","2037","2088","2060","2065","2089","2061","2090","2087","2350","2360","2400","2370","2354","2365","2358","2402","2404","2371","2406","2361","2369","2359","2409","2403","2399","2405","2347","2453","2401","2408","2410","2440","2398","2390","2411","4385","2397","2833","2387","2210","2223","2222","2209","2221","2220","2800","2870","2871","2866","2804","2869","2865","2875","2806","2864","2867","2868","2876","2874","2798","2805","2799","2795","2877","2810","2440","2446","2448","2447","2431","2454","2441","2455","2453","2449","2429","2444","2439","2150","2127","2151","2142","2115","2145","2116","2128","2141","2117","2114","2750","2747","2749","2101","2107","2103","2106","2102","2104","2108","2084","2105","2097","2085","2080","2444","2443","2445","2427","2439","2446","2426","2898","2430","2324","2315","2318","2317","2316","2319","2321","2322","2320","2423","2425","2145","2164","2147","2146","2148","2176","2165","2766","2175","2763","2762","2765","2155","2769","2768","2216","2205","2217","2219","2207","2122","2112","2114","2113","2121","2118","2093","2529","2530","2528","2527","2540","2539","2541","2538","2536","2622","2140","2135","2134","2132","2133","2136","2194","2191","2131","2193","2046","2137","2204","2131","2203","2130","2193","2045","2133","2049","2044","2280","2281","2259","2262","2290","2282","2000","2010","2011","2009","2021","2007","2025","2033","2340","2380","2343","2346","2352","2347","2341","2381","2339","2353","2355","2344","2342","2345","2354","2379","2338","2382","2359","2251","2260","2250","2257","2261","2261","2250","2258","2259","2260","2486","2485","2487","2489","2488","2484","2483","2490","2330","2333","2337","2422","2320","2420","2335","2329","2321","2328","2336","2425","2421","2338","2311","2415","2324","2850","2325","2331","2424","2340","2354","2026","2027","2030","2029","2023","2025","2028","2022","2650","2720","2652","2656","2655","2651","2729","2730","2642","2658","2722","2661","2702","2611","2678","2645","2649","2659","2076","2120","2077","2074","2073","2075","2099","2100","2097","2087","2086","2085","2101","2084","2287","2299","2298","2285","2322","2305","2307","2289","2308","2067","2065","2068","2064","2090","2062","2063","2069","2089","2066","2060","2088","2147","2152","2153","2768","2145","2146","2148","2151","2575","2576","2571","2570","2573","2572","2752","2574","2568","2569","2745","2787","2500","2502","2506","2518","2505","2530","2519","2528","2525","2526","2259","2263","2262","2261","2258","2648"],"n":[25595,10404,5588,2983,2763,2040,1885,1733,1038,936,582,443,423,221,173,114,102,29,25,5,16978,13153,5940,4886,4411,1814,187,6,12801,9648,9159,1547,1358,1071,1014,975,173,145,1,23529,11183,7090,5945,3267,2661,57,13959,12794,10254,7289,5929,5748,3432,316,14,13,1,22760,11515,11509,2937,1838,952,531,10,13706,6290,3459,3320,3286,2816,2578,2531,2424,1949,1678,1654,1608,1396,1367,1359,1186,1125,1024,931,913,786,780,759,685,599,577,402,386,344,318,272,262,231,191,167,136,124,124,102,89,81,60,60,60,57,10,1,1,1,26841,10159,3628,2951,1689,1552,1395,1146,1045,747,517,484,379,353,124,65,49,46,18293,11971,11312,9022,7175,3529,2795,841,35,32,26722,8524,5105,1958,49,4,11442,8726,5726,4250,4190,2605,2532,1902,1881,1441,1398,868,95,28,17961,13656,3129,1957,14,16797,14883,6849,1,38627,1506,453,3,11837,10390,8768,7564,5935,3762,2976,388,19803,10966,4984,4748,1683,3,17754,7947,4379,3793,2629,2118,1777,1660,1490,840,746,160,124,17202,8888,7304,4014,2750,1724,784,180,3,1,19371,8541,6000,5283,2773,2328,1755,1751,1502,1436,526,460,235,170,42,7,29786,10391,9014,16,11,23480,13470,12058,6946,3915,3309,2940,8313,7256,4768,4645,3524,3146,2869,2767,2751,2414,2286,2275,1879,1222,1170,941,730,509,470,460,341,335,326,309,287,281,267,262,209,205,204,195,89,80,44,34,30,11,6,5,2,19808,15364,3485,3017,2214,1278,9667,7287,6305,5634,4387,3990,2814,1695,520,15502,15014,11355,8744,688,2,26136,13644,5215,3265,2762,1167,758,585,287,263,211,120,56,32,30,7,2,10256,9037,8862,6725,2168,2008,1740,394,16131,11776,8949,5257,3699,116,86,19283,5430,5071,2334,2308,1982,1843,1744,1430,26678,15603,11079,651,621,2,21151,9771,8023,4106,3285,2055,1972,1345,594,457,437,263,139,58,39,1,18550,13244,10087,8274,770,579,306,19189,10341,7699,4636,4603,1107,1050,539,179,13,7,6,1,13268,13175,5976,4161,2678,1470,1,23889,14594,12790,10386,5689,4839,2730,41,12,28177,6398,4907,1042,1,17231,7498,3290,2568,2410,2292,2236,1681,1060,766,721,596,248,141,65,63,7756,7583,7026,6363,4717,4343,365,46,24372,11992,1836,1,11776,9869,9446,5887,4113,2499,1291,76,74,19,19615,10293,9665,9307,5461,3207,1682,105,13845,10183,6956,4112,2673,2453,1801,1079,465,102,20113,9864,5927,5544,4932,4504,196,10951,9678,4347,4093,3181,2230,1466,747,552,1,28319,10554,4285,4103,2021,770,658,335,284,249,240,182,110,109,87,74,42,16,19195,15980,4110,3187,19478,14394,8931,3071,1036,294,291,1,11991,9132,6331,5554,4614,4165,8,1,15220,13057,8478,5585,170,58,27,14424,12081,11969,8609,3676,3220,3039,19544,18244,9435,3179,532,5,11548,8039,6136,5937,4238,3825,3709,2196,25986,6435,5549,4057,3945,3376,2972,1914,806,756,751,438,389,374,362,191,78,25596,6858,6464,15607,7231,6695,5801,2614,2512,2355,1912,1693,1452,1394,1307,1245,1234,1149,1069,1050,960,894,811,618,503,477,439,311,260,231,182,60,55,49,20,7,24211,23916,6222,2814,934,537,130,78,12345,10384,7446,7184,4682,3001,2475,2246,1499,1494,1263,1151,1079,419,211,34,14015,11393,9022,8663,7380,4739,4304,2078,2007,231,98,96,18,9,2,18897,16040,11482,7738,6208,4788,2,18556,8805,6776,5361,3220,2973,2388,1535,1366,902,744,684,597,579,564,437,402,376,345,248,237,190,179,143,118,70,65,58,35,20,12,17193,11633,7251,5237,2712,1230,28137,8006,6041,1682,1510,932,606,596,540,521,381,324,314,287,172,29,21,12,6,3,14371,7464,7054,5044,4883,4461,2532,2339,1746,1343,428,157,4,27552,14062,7587,7326,5987,5969,4148,2515,2292,1864,632,32111,11240,6181,10793,7244,6734,5108,4717,2405,1864,1725,1253,12,4,1,35266,6749,4440,2868,2300,591,396,190,9,18875,15068,6637,5599,5246,4169,965,729,573,8,3,22201,9819,5907,4581,2832,1537,282,77,1,11212,9367,6964,6761,5952,4361,18285,14778,11012,8772,3584,16960,16502,14224,12240,1649,1028,1,15594,12976,11558,1509,32396,17771,8043,2021,314,17,13737,13642,12432,5089,5028,4672,3354,2973,1000,31,11,1,15724,13784,9084,4906,4220,2987,261,99,1,13791,9516,9406,8016,1974,3,61778,31721,22681,12169,11032,1924,21,14,33811,7180,4003,2050,1594,1407,1170,1127,727,640,553,480,453,365,155,132,114,84,29,20830,14425,7513,4444,1,32509,11302,2577,1215,3,19502,12194,11280,5118,2340,1957,983,348,13003,8789,5637,4153,4093,3083,2856,1908,1721,1706,1678,1387,1241,1109,813,352,159,31,17,15,7,2,1,21002,7657,7491,7012,6267,5760,4879,1065,37143,5449,2104,1569,1406,1166,1101,1048,339,233,141,127,75,44,12,8,5,3,11655,8928,8441,7963,7552,24,12785,10032,7155,5314,3878,1499,159,2,19029,6688,4043,3921,3399,2657,2367,78,11,18576,9372,8137,6429,5075,4628,3087,2404,2327,1154,167,2,11994,6347,5760,5178,4646,4440,4039,783,9498,9398,6700,4456,3359,3018,2809,2748,653,591,137,31,25597,7053,3830,3731,3439,3146,2617,2024,1125,961,23422,16118,2631,1297,301,1],"per_of_district":[44.839,18.2264,9.7894,5.2258,4.8404,3.5738,3.3023,3.036,1.8184,1.6397,1.0196,0.7761,0.741,0.3872,0.3031,0.1997,0.1787,0.0508,0.0438,0.0088,35.8375,27.7636,12.5383,10.3135,9.3108,3.829,0.3947,0.0127,33.7829,25.4618,24.1713,4.0827,3.5839,2.8265,2.676,2.5731,0.4566,0.3827,0.0026,43.7895,20.8126,13.1951,11.0642,6.0802,4.9524,0.1061,23.3627,21.4129,17.1618,12.1994,9.9232,9.6202,5.744,0.5289,0.0234,0.0218,0.0017,43.7255,22.1221,22.1106,5.6424,3.5311,1.8289,1.0201,0.0192,21.3273,9.7876,5.3824,5.1661,5.1132,4.3819,4.0115,3.9384,3.7719,3.0328,2.6111,2.5737,2.5021,2.1723,2.1271,2.1147,1.8455,1.7506,1.5934,1.4487,1.4207,1.2231,1.2137,1.181,1.0659,0.9321,0.8978,0.6255,0.6006,0.5353,0.4948,0.4232,0.4077,0.3594,0.2972,0.2599,0.2116,0.193,0.193,0.1587,0.1385,0.126,0.0934,0.0934,0.0934,0.0887,0.0156,0.0016,0.0016,0.0016,50.4815,19.1066,6.8234,5.5501,3.1766,2.9189,2.6237,2.1554,1.9654,1.4049,0.9724,0.9103,0.7128,0.6639,0.2332,0.1222,0.0922,0.0865,28.1409,18.4155,17.4017,13.8789,11.0376,5.4288,4.2997,1.2937,0.0538,0.0492,63.0801,20.1218,12.0509,4.6221,0.1157,0.0094,24.3012,18.5328,12.1612,9.0264,8.899,5.5327,5.3776,4.0396,3.995,3.0605,2.9692,1.8435,0.2018,0.0595,48.9174,37.1926,8.5219,5.33,0.0381,43.5946,38.627,17.7758,0.0026,95.1662,3.7104,1.1161,0.0074,22.931,20.1279,16.9857,14.6532,11.4975,7.2879,5.7652,0.7516,46.941,25.9938,11.8141,11.2547,3.9894,0.0071,39.0911,17.4979,9.6418,8.3515,5.7886,4.6635,3.9126,3.655,3.2807,1.8495,1.6426,0.3523,0.273,40.1447,20.7421,17.0455,9.3676,6.4177,4.0233,1.8296,0.4201,0.007,0.0023,37.1234,16.3683,11.4987,10.1246,5.3143,4.4615,3.3634,3.3557,2.8785,2.752,1.008,0.8816,0.4504,0.3258,0.0805,0.0134,60.5185,21.1122,18.3144,0.0325,0.0223,35.5123,20.3727,18.2371,10.5055,5.9212,5.0047,4.4466,14.3533,12.5283,8.2325,8.0201,6.0846,5.4319,4.9536,4.7775,4.7499,4.168,3.947,3.928,3.2443,2.1099,2.0201,1.6247,1.2604,0.8788,0.8115,0.7942,0.5888,0.5784,0.5629,0.5335,0.4955,0.4852,0.461,0.4524,0.3609,0.354,0.3522,0.3367,0.1537,0.1381,0.076,0.0587,0.0518,0.019,0.0104,0.0086,0.0035,43.856,34.0167,7.716,6.6798,4.9019,2.8296,22.854,17.2274,14.9058,13.3195,10.3714,9.4328,6.6526,4.0072,1.2293,30.2154,29.2642,22.1323,17.0432,1.341,0.0039,47.9208,25.0165,9.5618,5.9864,5.0642,2.1397,1.3898,1.0726,0.5262,0.4822,0.3869,0.22,0.1027,0.0587,0.055,0.0128,0.0037,24.8992,21.9398,21.5149,16.3268,5.2634,4.875,4.2243,0.9565,35.0567,25.5922,19.4484,11.4248,8.0389,0.2521,0.1869,46.5492,13.108,12.2414,5.6343,5.5715,4.7846,4.449,4.21,3.452,48.8304,28.5591,20.2786,1.1916,1.1367,0.0037,39.3903,18.1969,14.9415,7.6468,6.1178,3.8271,3.6725,2.5048,1.1062,0.8511,0.8138,0.4898,0.2589,0.108,0.0726,0.0019,35.8039,25.5626,19.4692,15.9699,1.4862,1.1175,0.5906,38.8677,20.9459,15.5945,9.3903,9.3235,2.2423,2.1268,1.0918,0.3626,0.0263,0.0142,0.0122,0.002,32.5763,32.348,14.6726,10.2163,6.5752,3.6092,0.0025,31.8647,19.4665,17.0602,13.8535,7.5884,6.4546,3.6415,0.0547,0.016,69.5299,15.7878,12.1086,2.5713,0.0025,40.1974,17.4917,7.6751,5.9908,5.6222,5.3469,5.2163,3.9215,2.4728,1.787,1.682,1.3904,0.5785,0.3289,0.1516,0.147,20.3042,19.8513,18.3932,16.6575,12.3485,11.3694,0.9555,0.1204,63.7994,31.3918,4.8062,0.0026,26.1398,21.9068,20.9678,13.0677,9.1299,5.5472,2.8657,0.1687,0.1643,0.0422,33.0581,17.3473,16.2889,15.6855,9.2037,5.4049,2.8348,0.177,31.7044,23.3186,15.9289,9.4163,6.121,5.6173,4.1242,2.4709,1.0648,0.2336,39.3755,19.3109,11.6034,10.8536,9.6554,8.8175,0.3837,29.4018,25.984,11.6711,10.9891,8.5405,5.9872,3.936,2.0056,1.482,0.0027,54.0047,20.1266,8.1716,7.8245,3.8541,1.4684,1.2548,0.6388,0.5416,0.4748,0.4577,0.3471,0.2098,0.2079,0.1659,0.1411,0.0801,0.0305,45.1945,37.6248,9.677,7.5038,41.0098,30.3057,18.8037,6.4658,2.1812,0.619,0.6127,0.0021,28.6893,21.849,15.1474,13.2884,11.0393,9.9651,0.0191,0.0024,35.7319,30.6538,19.9037,13.1119,0.3991,0.1362,0.0634,25.2973,21.188,20.9916,15.0987,6.4471,5.6473,5.3299,38.3675,35.8154,18.5222,6.2408,1.0444,0.0098,25.309,17.6186,13.4479,13.0117,9.2882,8.383,8.1288,4.8128,44.5126,11.0228,9.5051,6.9494,6.7576,5.7829,5.0909,3.2786,1.3806,1.295,1.2864,0.7503,0.6663,0.6406,0.6201,0.3272,0.1336,65.7691,17.6217,16.6093,25.0929,11.626,10.7642,9.3268,4.2028,4.0388,3.7864,3.0741,2.722,2.3345,2.2413,2.1014,2.0017,1.984,1.8474,1.7187,1.6882,1.5435,1.4374,1.3039,0.9936,0.8087,0.7669,0.7058,0.5,0.418,0.3714,0.2926,0.0965,0.0884,0.0788,0.0322,0.0113,41.1458,40.6444,10.5741,4.7823,1.5873,0.9126,0.2209,0.1326,21.691,18.2454,13.0831,12.6228,8.2266,5.273,4.3487,3.9464,2.6338,2.6251,2.2192,2.0224,1.8959,0.7362,0.3707,0.0597,21.8796,17.7863,14.0848,13.5243,11.5213,7.3983,6.7192,3.2441,3.1332,0.3606,0.153,0.1499,0.0281,0.0141,0.0031,29.0031,24.6182,17.6226,11.8763,9.528,7.3486,0.0031,32.0014,15.185,11.6858,9.2455,5.5532,5.1272,4.1183,2.6472,2.3558,1.5556,1.2831,1.1796,1.0296,0.9985,0.9727,0.7536,0.6933,0.6484,0.595,0.4277,0.4087,0.3277,0.3087,0.2466,0.2035,0.1207,0.1121,0.1,0.0604,0.0345,0.0207,37.9905,25.7049,16.0222,11.5719,5.9926,2.7179,56.1393,15.9737,12.0531,3.3559,3.0128,1.8595,1.2091,1.1891,1.0774,1.0395,0.7602,0.6464,0.6265,0.5726,0.3432,0.0579,0.0419,0.0239,0.012,0.006,27.7293,14.402,13.6109,9.7326,9.4219,8.6076,4.8856,4.5132,3.369,2.5914,0.8258,0.3029,0.0077,34.4684,17.592,9.4916,9.1651,7.4899,7.4674,5.1893,3.1463,2.8674,2.3319,0.7907,64.8288,22.6924,12.4788,25.7836,17.3053,16.087,12.2026,11.2685,5.7453,4.4529,4.1209,2.9933,0.0287,0.0096,0.0024,66.7803,12.78,8.4077,5.4309,4.3553,1.1191,0.7499,0.3598,0.017,32.6151,26.0368,11.4684,9.6748,9.0648,7.2038,1.6675,1.2597,0.9901,0.0138,0.0052,46.9992,20.7867,12.505,9.6979,5.9953,3.2538,0.597,0.163,0.0021,25.1294,20.9942,15.6084,15.1534,13.3402,9.7743,32.4024,26.1877,19.5141,15.5446,6.3511,27.0909,26.3593,22.7206,19.5515,2.634,1.6421,0.0016,37.4523,31.1646,27.759,3.6242,53.4923,29.3435,13.2806,3.3371,0.5185,0.0281,22.1672,22.0139,20.0613,8.212,8.1136,7.5391,5.4123,4.7975,1.6137,0.05,0.0178,0.0016,30.7915,26.9925,17.7887,9.6072,8.2638,5.8493,0.5111,0.1939,0.002,32.2929,22.2826,22.025,18.7702,4.6223,0.007,43.7088,22.443,16.0471,8.6097,7.8053,1.3613,0.0149,0.0099,60.2971,12.8045,7.1388,3.6559,2.8427,2.5092,2.0865,2.0098,1.2965,1.1413,0.9862,0.856,0.8079,0.6509,0.2764,0.2354,0.2033,0.1498,0.0517,44.1192,30.553,15.913,9.4127,0.0021,68.2876,23.7407,5.4132,2.5522,0.0063,36.3017,22.6983,20.997,9.5268,4.3558,3.6428,1.8298,0.6478,24.1867,16.3483,10.4853,7.7249,7.6133,5.7346,5.3124,3.549,3.2012,3.1733,3.1212,2.5799,2.3084,2.0628,1.5122,0.6547,0.2958,0.0577,0.0316,0.0279,0.013,0.0037,0.0019,34.3546,12.5252,12.2536,11.4701,10.2514,9.4221,7.981,1.7421,71.466,10.4843,4.0483,3.0189,2.7053,2.2435,2.1184,2.0164,0.6523,0.4483,0.2713,0.2444,0.1443,0.0847,0.0231,0.0154,0.0096,0.0058,26.154,20.0346,18.9417,17.8691,16.9468,0.0539,31.3174,24.5738,17.5265,13.0169,9.4993,3.6719,0.3895,0.0049,45.0999,15.851,9.5822,9.293,8.0558,6.2973,5.6099,0.1849,0.0261,30.2748,15.2743,13.2615,10.4779,8.2711,7.5426,5.0311,3.918,3.7925,1.8808,0.2722,0.0033,27.7722,14.6966,13.3373,11.9897,10.7579,10.2809,9.3524,1.813,21.8858,21.6554,15.4385,10.2678,7.74,6.9542,6.4726,6.3321,1.5047,1.3618,0.3157,0.0714,47.8243,13.1775,7.1558,6.9708,6.4253,5.8778,4.8895,3.7816,2.1019,1.7955,53.5128,36.8252,6.0111,2.9633,0.6877,100],"per_of_postcode":[100,100,99.1307,89.7953,99.7473,100,100,100,100,80.0684,99.4872,10.3699,98.1439,5.8081,100,0.3033,11.8881,100,83.3333,0.3177,100,85.1602,69.2308,57.7268,100,44.7791,0.6302,0.044,98.9411,100,32.1391,67.4368,99.9264,11.407,100,76.8322,2.558,100,0.0059,100,100,99.4111,85.8112,83.2357,96.0303,0.1997,99.9356,99.9844,100,79.1165,100,100,44.364,2.531,0.1549,0.2736,0.0114,76.7053,100,75.3651,22.038,21.7155,5.2466,6.7747,0.1127,100,98.8994,100,100,99.8177,100,100,100,100,100,100,73.8723,100,100,94.2109,100,100,95.2583,100,100,100,100,100,100,100,99.6672,96.6499,95.2607,91.6865,100,19.0419,100,100,100,100,21.8873,10.768,91.1765,3.792,43.5897,25.2841,22.0109,3.0488,4.89,0.9817,0.2176,0.52,0.057,0.8403,0.0362,99.9293,100,98.3998,98.1703,100,100,100,100,85.8669,5.1796,92.1569,100,98.6979,100,7.9233,0.3012,1.1398,0.163,98.3125,100,100,100,100,100,100,100,0.8202,1.0652,79.5463,100,42.6732,14.8671,0.7245,0.0152,100,100,100,98.8602,100,100,100,100,100,92.0767,100,100,2.0221,0.7594,77.9828,80.6235,5.2622,32.2565,0.1084,100,52.2247,72.9471,0.0088,100,99.9336,100,0.032,77.9211,77.962,100,100,58.2662,24.6349,48.132,4.9502,91.2412,38.1851,95.1508,72.878,39.5907,0.04,99.8313,45.9603,100,98.4939,24.1193,100,98.5033,36.7582,6.9704,64.3678,5.365,1.233,0.2718,89.7059,86.8902,87.0975,59.8658,15.9042,100,9.8394,1.2884,0.1334,0.0134,99.9432,97.1672,100,100,100,100,46.4778,100,86.2227,94.2876,1.7353,18.7449,100,0.5955,0.7773,0.0673,98.2647,99.9327,100,0.3574,0.0568,100,96.2005,91.8845,100,15.7122,35.8972,37.7262,100,100,100,100,92.615,96.208,100,99.8917,100,94.4814,97.6506,100,100,28.6049,70.0599,100,90.6832,100,23.7374,100,99.7076,100,0.8674,91.4201,100,100,100,100,15.9542,100,100,100,1.0971,1.9111,7.8431,1.1311,0.4461,0.18,1,1.3021,0.0367,93.0915,80.5537,47.6744,14.6999,16.0878,100,99.7523,100,100,100,64.6002,72.6379,26.1112,30.4145,6.442,99.9291,99.9933,100,100,4.7695,0.0161,99.7824,94.6055,100,100,99.9638,95.11,100,26.1277,23.5439,74.7159,11.1463,27.027,4.7417,0.1134,7.2993,0.0261,0.3328,100,100,99.8873,22.6645,100,58.4061,20.5577,9.726,90.7255,91.9713,82.7615,100,30.6488,1.2033,1.32,98.5587,100,22.0172,27.2028,17.8762,13.0172,45.4949,10.2964,41.5939,58.4813,77.8321,100,45.9421,34.2715,0.0055,98.0211,88.3294,98.9029,98.0889,100,100,96.1951,4.9212,99,100,4.3986,2.7223,3.2576,1.689,46.988,0.2924,100,86.9828,23.5112,53.0385,5.9639,2.0582,3.5664,99.6728,39.4093,71.4856,100,97.9779,60.558,57.947,100,0.5717,0.0731,0.0538,0.1145,0.0022,64.6463,100,100,100,88.0053,6.9085,0.0204,99.0423,100,99.9609,83.8054,99.9824,62.0942,29.616,0.3703,0.1623,47.3866,51.0452,99.9796,100,0.0049,67.1198,99.96,100,60.4093,100,100,100,25.802,99.9057,54.0579,39.442,6.1826,4.7346,7.7815,0.2995,0.3272,88.9756,67.0232,100,70.8575,15.5605,79.4257,11.9947,0.2832,77.836,41.7578,8.4593,0.0105,88.6413,100,54.0111,100,100,7.1615,11.6706,0.485,0.4556,0.4453,94.0993,100,72.9489,45.8044,66.8176,51.868,21.4596,1.4274,100,100,100,100,15.4589,6.7209,100,12.8667,35.6322,0.7335,94.5738,100,32.6251,25.1474,100,17.7617,1.0441,99.927,75.2215,7.3106,100,20.9663,19.6251,15.614,32.5632,3.339,0.0664,99.2048,84.3578,100,100,53.5222,100,16.7643,100,23.946,2.8328,13.7773,100,3.9697,100,5.7124,100,0.5889,100,32.2811,96.661,67.7435,24.7707,100,56.152,34.0358,28.5144,14.355,23.1678,3.013,0.0039,79.0337,80.3661,100,100,7.7596,100,0.073,0.0078,71.2013,93.9015,65.331,51.2385,0.8852,1.5061,1.4967,100,99.9917,48.3518,100,100,24.2982,100,100,100,100,34.4869,3.7995,0.0391,83.9122,100,48.9548,100,20.649,52.3256,19.4463,100,95.0788,100,100,95.0785,100,98.311,98.9348,100,100,88.1119,100,100,100,100,1.6776,100,3.8049,99.9961,57.3268,95.5789,100,100,99.5539,100,100,100,100,99.428,100,100,100,100,100,100,100,100,100,100,100,100,100,11.7743,100,100,100,100,100,10.8982,1.5769,2.3494,0.8693,4.7393,0.2527,99.9628,100,93.5639,99.7165,100,98.7132,3.0353,16.4557,100,100,99.9866,90.1606,100,100,100,99.8666,100,100,12.3472,22.1602,100,5.9382,1.626,0.5071,100,100,99.8451,98.8588,99.8377,99.7264,55.636,11.6728,16.1946,0.9577,1.0673,0.1552,0.0567,0.0644,0.0156,99.9894,98.9696,45.2796,76.8803,100,48.5451,0.0376,100,100,100,99.2227,95.3791,100,100,100,100,76.054,100,100,100,95.2303,100,100,100,100,19.6805,10.1059,100,100,100,0.9853,99.1597,1.1006,100,100,8.3135,3.3501,8.8235,94.7534,100,98.5726,66.8155,33.1824,5.9007,99.7236,100,98.8384,88.8537,76.2626,76.4561,100,78.1127,100,100,92.7007,72.973,100,77.9891,14.1331,8.5799,0.6986,0.0447,0.1823,0.1083,99.0147,92.6629,100,100,100,99.6426,100,100,71.1491,100,6.4361,0.4432,0.1736,97.9418,100,62.8635,46.9615,100,13.9128,100,100,14.8398,17.2385,4.2542,100,43.848,85.645,98.5482,100,100,100,100,100,100,99.8842,100,0.1674,0.0728,0.0943,99.5568,100,100,100,99.8264,7.3371,83.5443,100,0.0372,98.2868,100,94.0618,100,100,100,8.8532,5.6176,2.6806,0.2835,0.2158,51.747,76.0514,32.9982,50.7815,8.4303,9.0743,1.4413,1.1385,0.0736,85.1329,96.987,26.5396,21.5924,100,45.7128,100,100,54.1956,100,27.0511,100,74.8526,95.7458,67.3749,9.2745,8.0287,0.0083,99.515,79.8916,85.0979,11.3587,92.8385,100,45.9889,100,1.6875,0.3984,95.2305,99.956,99.9839,100,95.0652,100,22.0789,100,6.7641,0.3043,0.0709,0.0067,88.3272,93.2359,98.9327,100,41.4294,100,4.9348,1.1298,0.0176,98.7116,100,25.7713,75.2888,10.2941,0.0358,99.8448,99.9433,100,97.469,99.6297,20.8835,0.3633,0.1796,99.9941,100,100,100,100,80.2624,100,89.232,100,100,100,100,100,100,4.5912,56.4103,9.3213,5.7891,4.7697,100,99.9792,16.4694,22.1679,0.003,96.1606,24.7753,89.5413,3.3289,0.0208,100,100,100,100,100,15.6422,14.1888,100,99.9462,100,100,96.9647,19.1476,100,63.2418,96.9512,15.789,100,100,99.7842,100,90.6787,100,100,0.828,0.2149,0.0956,100,1.2868,0.0059,0.0296,84.2878,100,100,100,100,99.6367,100,8.1155,98.8293,99.9633,49.2509,99.6823,100,100,84.0458,100,10.2047,19.9316,5.5186,100,9.3168,53.012,100,1.8561,16.6667,0.5128,100,92.6141,32.8802,73.8888,93.558,0.2477,51.6482,75.7018,99.8326,99.9624,69.5855,27.2893,1.4518,0.1158,100,100,77.8398,22.6765,26.1925,39.6271,100,0.7625,100,98.9559,36.9588,100,100,51.4549,100,100,35.3998,23.1197,5.4262,1.0304,0.0106,67.0018,100,20.0571,54.2767,10.8291,49.2185,12.0233,6.4877,95.6014,97.2777,100,15.6362,100,100,100,100,100,100,1.0589,0.8408,84.4395,100,100,32.9768,100,19.3695,29.1425,14.9021,20.5743,11.0244,64.1734,100,24.7112,3.8365,10.4587,0.052]}}]}
</script>


</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <div class="quarto-title-block"><div><h1 class="title">NSW 2023 legislative districts to postcodes: correspondence file &amp; mapping application</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          <p>We derive the correspondence between NSW legislative districts and postcodes via a spatial merge, using the G-NAF and a MapInfo file of district boundaries from the NSW Electoral Commission. We also provide an interactive tabular summary and map of the correspondence.</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Simon Jackman </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2:51PM 15 November 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#inputs" id="toc-inputs" class="nav-link active" data-scroll-target="#inputs">Inputs</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#read-g-naf" id="toc-read-g-naf" class="nav-link" data-scroll-target="#read-g-naf">Read G-NAF</a></li>
  <li><a href="#nsw-state-legislative-districts" id="toc-nsw-state-legislative-districts" class="nav-link" data-scroll-target="#nsw-state-legislative-districts">NSW state legislative districts</a></li>
  <li><a href="#read-postcode-shapefiles" id="toc-read-postcode-shapefiles" class="nav-link" data-scroll-target="#read-postcode-shapefiles">Read postcode shapefiles</a></li>
  <li><a href="#matching-addresses-to-districts" id="toc-matching-addresses-to-districts" class="nav-link" data-scroll-target="#matching-addresses-to-districts">Matching addresses to districts</a></li>
  <li><a href="#counts-of-addresses-by-legislative-district" id="toc-counts-of-addresses-by-legislative-district" class="nav-link" data-scroll-target="#counts-of-addresses-by-legislative-district">Counts of addresses by legislative district</a></li>
  <li><a href="#sec-interactive" id="toc-sec-interactive" class="nav-link" data-scroll-target="#sec-interactive">Linked table and map</a></li>
  <li><a href="#write-to-file" id="toc-write-to-file" class="nav-link" data-scroll-target="#write-to-file">Write to file</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">




<section id="inputs" class="level1">
<h1>Inputs</h1>
<p>Not included in this repo for size and/or license restrictions:</p>
<ul>
<li><p>NSW Electoral Commission <a href="https://www.elections.nsw.gov.au/NSWEC/media/NSWEC/Maps/index-maps/StateElectoralDistrict2021_GDA2020.zip">MapInfo file</a></p></li>
<li><p>List of NSW addresses from the August 2022 G-NAF (the <a href="https://geoscape.com.au/data/g-naf-core/">Geocoded National Address File</a>).</p></li>
</ul>
<p>For making maps, we use the (very good) approximations to <a href="https://www.abs.gov.au/statistics/standards/australian-statistical-geography-standard-asgs-edition-3/jul2021-jun2026/non-abs-structures/postal-areas">postcode geographies</a> provided in <a href="https://www.abs.gov.au/statistics/standards/australian-statistical-geography-standard-asgs-edition-3/jul2021-jun2026/access-and-downloads/digital-boundary-files/POA_2021_AUST_GDA94_SHP.zip">shapefiles</a> published by the Australian Bureau of Statistics.</p>
</section>
<section id="methodology" class="level1">
<h1>Methodology</h1>
<ul>
<li>Every G-NAF address in NSW is geocoded using <a href="https://epsg.io/4939">GDA94</a> or <a href="https://epsg.io/7844">GDA 2020 CRS</a>, the same CRS used for both the NSW legislative district <code>MapInfo</code> file and ABS postal area shape files.</li>
<li>Locate each geo-coded NSW address from G-NAF in a NSW legislative district, using functions in the <a href="https://journal.r-project.org/archive/2018/RJ-2018-009/RJ-2018-009.pdf"><code>sf</code> R package</a>.</li>
<li>For each postcode, compute and report count and what proportion of its geo-coded addresses lie in each district.</li>
<li>Use <a href="https://leafletjs.com" title="https://leafletjs.com"><code>leaflet</code></a> to build a JS mapping/visualization application.</li>
<li><a href="https://quarto.org"><code>quarto</code></a> assembles this document and the web application, in turn utilising <a href="https://observablehq.com/@observablehq/observables-not-javascript"><code>Observable JS</code></a> for table building and the call to <code>leaflet</code> (<a href="#sec-interactive">Section&nbsp;8</a>).</li>
</ul>
</section>
<section id="read-g-naf" class="level1">
<h1>Read G-NAF</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>gnaf <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> gnaf_core, <span class="at">delim =</span> <span class="st">"|"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>nsw_addresses <span class="ot">&lt;-</span> gnaf <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"NSW"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.fst</span>(nsw_addresses, <span class="at">path =</span> <span class="fu">here</span>(<span class="st">"data/gnaf_subset.fst"</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gnaf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>nsw_addresses <span class="ot">&lt;-</span> <span class="fu">read.fst</span>(<span class="at">path =</span> <span class="fu">here</span>(<span class="st">"data/gnaf_subset.fst"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_addresses <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(postcode,longitude,latitude)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(nsw_geo,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">'longitude'</span>, <span class="st">'latitude'</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We subset the G-NAF “core” file to NSW addresses, yielding 4,772,933 addresses, spanning 622 postcodes and 2,894,120 distinct geo-codes (latitude/longitude pairs).</p>
</section>
<section id="nsw-state-legislative-districts" class="level1">
<h1>NSW state legislative districts</h1>
<p>We read the <a href="https://www.elections.nsw.gov.au/NSWEC/media/NSWEC/Maps/index-maps/StateElectoralDistrict2021_GDA2020.zip">MapInfo file</a> supplied by the <a href="https://www.elections.nsw.gov.au/redistribution/Final-boundaries-and-names">NSW Electoral Commission</a>; this employs the <code>GDA2020</code> CRS and contain the boundaries for NSW’s 93 electorate districts, to be used in the 2023 election (gazetted and proclaimed on 26 August 2021).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>nsw_shp <span class="ot">&lt;-</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_read</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dsn =</span> <span class="fu">here</span>(<span class="st">"data/StateElectoralDistrict2021_GDA2020.MID"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">query =</span> <span class="fu">sprintf</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"SELECT objectid, cadid, districtna from StateElectoralDistrict2021_GDA2020"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>nsw_shp <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(nsw_shp, <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>nsw_shp <span class="ot">&lt;-</span> <span class="fu">as</span>(nsw_shp, <span class="st">"sf"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_make_valid</span>() </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>geojsonio<span class="sc">::</span><span class="fu">geojson_write</span>(nsw_shp,<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data/nsw_shp.json"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read-postcode-shapefiles" class="level1">
<h1>Read postcode shapefiles</h1>
<p>For map-making later on, we read the ABS postal areas (postcode) shapefiles; the coordinates use the <code>GDA2020</code> geodetic CRS, which corresponds to <code>EPSG:7843</code> CRS used in the other data sets we utilize.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_read</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">here</span>(<span class="st">"data/POA_2021_AUST_GDA2020_SHP/POA_2021_AUST_GDA2020.shp"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(poa_shp) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(poa_shp, <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span> <span class="fu">as</span>(poa_shp, <span class="st">"sf"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_make_valid</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="matching-addresses-to-districts" class="level1">
<h1>Matching addresses to districts</h1>
<p>We now match the unique, geo-coded NSW addresses to districts, the real “work” of this exercise being done by the call to <code>sf::st_intersects</code> in the function <code>pfunc</code>; we group the data by <code>postcode</code> and use processing these batches of data in parallel via <code>furrr::future_map</code>.</p>
<div class="cell" data-hash="postcode_nsw_legislative_district_cache/html/st-intersect-work_a5db038b0cf052ca5f20db22c0dbd5bc">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pfunc <span class="ot">&lt;-</span> <span class="cf">function</span>(obj){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">st_intersects</span>(obj<span class="sc">$</span>geometry,nsw_shp)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(z))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_nest</span>(postcode) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">intersection =</span> <span class="fu">future_map</span>(<span class="at">.x =</span> data,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.f =</span> <span class="sc">~</span><span class="fu">pfunc</span>(.x))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data,intersection))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> nsw_shp<span class="sc">$</span>districtna[intersection])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We merge the results back against the GNAF addresses for NSW:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(nsw_geo<span class="sc">$</span>geometry)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude =</span> coords[,<span class="dv">1</span>],</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude =</span> coords[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>geometry) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>nsw_addresses <span class="ot">&lt;-</span> <span class="fu">left_join</span>(nsw_addresses,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                           nsw_geo,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"postcode"</span>, <span class="st">"longitude"</span>, <span class="st">"latitude"</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(nsw_geo,coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We also filter down to the subset of Australian postcodes that intersect NSW legislative districts:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span> poa_shp <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(nsw_addresses <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(postcode),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"POA_CODE21"</span> <span class="ot">=</span> <span class="st">"postcode"</span>)) </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>poa_shp_small <span class="ot">&lt;-</span> poa_shp <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_simplify</span>(<span class="at">preserveTopology =</span> <span class="cn">TRUE</span>, <span class="at">dTolerance =</span> <span class="dv">5</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>geojsonio<span class="sc">::</span><span class="fu">geojson_write</span>(poa_shp_small,<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data/nsw_poa_shp.json"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="counts-of-addresses-by-legislative-district" class="level1">
<h1>Counts of addresses by legislative district</h1>
<p>We compute counts of addresses with postcodes within districts; we also compute</p>
<ul>
<li>percentage of a district’s addresses in a given postcode (<code>per_of_district</code>)</li>
<li>percentage of a postcode’s addresses in a given district (<code>per_of_postcode</code>)</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> nsw_addresses <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(district,postcode) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(district) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">per_of_district =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(postcode) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">per_of_postcode =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(district,<span class="fu">desc</span>(per_of_district))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(nsw_addresses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ojs_define</span>(<span class="at">out_raw=</span>out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sec-interactive" class="level1">
<h1>Linked table and map</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" data-startfrom="227" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 226;"><span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> <span class="fu">transpose</span>(out_raw)</span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>viewof theDistrict <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(out<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">district</span>)<span class="op">,</span></span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"District: "</span><span class="op">,</span></span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sort</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unique</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>out_small <span class="op">=</span> out<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">district</span> <span class="op">==</span> theDistrict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" data-startfrom="238" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 237;"><span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>  out_small<span class="op">,</span></span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>   <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a>    <span class="dt">per_of_district</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>    <span class="dt">per_of_postcode</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)</span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rows</span><span class="op">:</span> out_small<span class="op">.</span><span class="at">length</span> <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css" integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14=" crossorigin="">
<script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js" integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg=" crossorigin=""></script>

<style>
  .leaflet-container {
      font-family: "Avenir", "Helvetica Neue", Arial, Helvetica, sans-serif;
      font-size: 12px;
      font-size: 0.75rem;
      line-height: 1.5;
    }

  .leaflet-tooltip-left:before {
    right: 0;
    margin-right: -12px;
    border-left: 0px;
    border-left-color: rgba(0, 0, 0, 0);
}
.leaflet-tooltip-right:before {
    left: 0;
    margin-left: -12px;
    border-right: 0px;
    border-right-color: rgba(0, 0, 0, 0);
    }
.leaflet-tooltip-own {
    position: absolute;
    padding: 4px;
    background-color: rgba(0, 0, 0, 0);
    border: 0px solid #000;
    color: #000;
    white-space: nowrap;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    pointer-events: none;
    box-shadow: 0 1px 3px rgba(0,0,0,0.4);
}
</style>     
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" data-startfrom="295" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 294;"><span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>nsw_shp_json <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"data/nsw_shp.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" data-startfrom="300" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 299;"><span id="cb13-300"><a href="#cb13-300" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="dv">800</span></span>
<span id="cb13-301"><a href="#cb13-301" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="dv">650</span></span>
<span id="cb13-302"><a href="#cb13-302" aria-hidden="true" tabindex="-1"></a>poa_shp_json <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data/nsw_poa_shp.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb13-303"><a href="#cb13-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-304"><a href="#cb13-304" aria-hidden="true" tabindex="-1"></a>thePostcodes <span class="op">=</span> out_small<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">postcode</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" data-startfrom="308" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 307;"><span id="cb14-308"><a href="#cb14-308" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="pp">require</span>(<span class="st">'leaflet@1.9.2'</span>)</span>
<span id="cb14-309"><a href="#cb14-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-310"><a href="#cb14-310" aria-hidden="true" tabindex="-1"></a>map2 <span class="op">=</span> {</span>
<span id="cb14-311"><a href="#cb14-311" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> container <span class="op">=</span> DOM<span class="op">.</span><span class="fu">element</span> (<span class="st">'div'</span><span class="op">,</span> { <span class="dt">style</span><span class="op">:</span> <span class="vs">`width:</span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px;height:</span><span class="sc">${</span>height<span class="sc">}</span><span class="vs">px`</span> })<span class="op">;</span></span>
<span id="cb14-312"><a href="#cb14-312" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> container<span class="op">;</span></span>
<span id="cb14-313"><a href="#cb14-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-314"><a href="#cb14-314" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> map <span class="op">=</span> L<span class="op">.</span><span class="fu">map</span>(container)</span>
<span id="cb14-315"><a href="#cb14-315" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> osmLayer <span class="op">=</span> L<span class="op">.</span><span class="fu">tileLayer</span>(<span class="st">'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.{ext}'</span><span class="op">,</span> {</span>
<span id="cb14-316"><a href="#cb14-316" aria-hidden="true" tabindex="-1"></a>      <span class="dt">attribution</span><span class="op">:</span> <span class="st">'Map tiles by &lt;a href="http://stamen.com"&gt;Stamen Design&lt;/a&gt;, &lt;a href="http://creativecommons.org/licenses/by/3.0"&gt;CC BY 3.0&lt;/a&gt; &amp;mdash; Map data &amp;copy; &lt;a href="https://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors'</span><span class="op">,</span></span>
<span id="cb14-317"><a href="#cb14-317" aria-hidden="true" tabindex="-1"></a>  <span class="dt">subdomains</span><span class="op">:</span> <span class="st">'abcd'</span><span class="op">,</span></span>
<span id="cb14-318"><a href="#cb14-318" aria-hidden="true" tabindex="-1"></a>    <span class="dt">minZoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb14-319"><a href="#cb14-319" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxZoom</span><span class="op">:</span> <span class="dv">25</span><span class="op">,</span></span>
<span id="cb14-320"><a href="#cb14-320" aria-hidden="true" tabindex="-1"></a>    <span class="dt">ext</span><span class="op">:</span> <span class="st">'png'</span></span>
<span id="cb14-321"><a href="#cb14-321" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb14-322"><a href="#cb14-322" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-323"><a href="#cb14-323" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">districtFilter</span>(feature) {</span>
<span id="cb14-324"><a href="#cb14-324" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">districtna</span> <span class="op">===</span> theDistrict) <span class="cf">return</span> <span class="kw">true</span></span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">postCodeFilter</span>(feature) {</span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(thePostcodes<span class="op">.</span><span class="fu">includes</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">POA_CODE21</span>)) <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">style</span>(feature) {</span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillColor</span><span class="op">:</span> <span class="st">"blue"</span><span class="op">,</span></span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>        <span class="dt">weight</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a>        <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb14-336"><a href="#cb14-336" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">'blue'</span><span class="op">,</span></span>
<span id="cb14-337"><a href="#cb14-337" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.0</span></span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb14-339"><a href="#cb14-339" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-340"><a href="#cb14-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-341"><a href="#cb14-341" aria-hidden="true" tabindex="-1"></a>  <span class="co">// highlight function</span></span>
<span id="cb14-342"><a href="#cb14-342" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">highlightFeature</span>(e) {</span>
<span id="cb14-343"><a href="#cb14-343" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> layer <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb14-344"><a href="#cb14-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-345"><a href="#cb14-345" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">setStyle</span>({</span>
<span id="cb14-346"><a href="#cb14-346" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb14-347"><a href="#cb14-347" aria-hidden="true" tabindex="-1"></a>        <span class="dt">opacity</span><span class="op">:</span> <span class="fl">1.0</span><span class="op">,</span></span>
<span id="cb14-348"><a href="#cb14-348" aria-hidden="true" tabindex="-1"></a>        <span class="dt">weight</span><span class="op">:</span> <span class="dv">3</span></span>
<span id="cb14-349"><a href="#cb14-349" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb14-350"><a href="#cb14-350" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-351"><a href="#cb14-351" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">openTooltip</span>()<span class="op">;</span></span>
<span id="cb14-352"><a href="#cb14-352" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-353"><a href="#cb14-353" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">bringToFront</span>()<span class="op">;</span></span>
<span id="cb14-354"><a href="#cb14-354" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-355"><a href="#cb14-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-356"><a href="#cb14-356" aria-hidden="true" tabindex="-1"></a>  <span class="co">// mouseout</span></span>
<span id="cb14-357"><a href="#cb14-357" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">resetHighlight</span>(e) {</span>
<span id="cb14-358"><a href="#cb14-358" aria-hidden="true" tabindex="-1"></a>    poaLayer<span class="op">.</span><span class="fu">resetStyle</span>(e<span class="op">.</span><span class="at">target</span>)<span class="op">;</span></span>
<span id="cb14-359"><a href="#cb14-359" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-360"><a href="#cb14-360" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-361"><a href="#cb14-361" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">onEachFeature</span>(feature<span class="op">,</span> layer) {</span>
<span id="cb14-362"><a href="#cb14-362" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">bindTooltip</span>(<span class="st">"&lt;div style='background:white; padding:1px 3px 1px 3px'&gt;&lt;b&gt;"</span> <span class="op">+</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">POA_CODE21</span> <span class="op">+</span> <span class="st">"&lt;/b&gt;&lt;/div&gt;"</span><span class="op">,</span></span>
<span id="cb14-363"><a href="#cb14-363" aria-hidden="true" tabindex="-1"></a>                     {</span>
<span id="cb14-364"><a href="#cb14-364" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">direction</span><span class="op">:</span> <span class="st">'right'</span><span class="op">,</span></span>
<span id="cb14-365"><a href="#cb14-365" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">permanent</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb14-366"><a href="#cb14-366" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">sticky</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb14-367"><a href="#cb14-367" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">offset</span><span class="op">:</span> [<span class="dv">10</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb14-368"><a href="#cb14-368" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb14-369"><a href="#cb14-369" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">className</span><span class="op">:</span> <span class="st">'leaflet-tooltip-own'</span></span>
<span id="cb14-370"><a href="#cb14-370" aria-hidden="true" tabindex="-1"></a>                     })<span class="op">;</span></span>
<span id="cb14-371"><a href="#cb14-371" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">on</span>({</span>
<span id="cb14-372"><a href="#cb14-372" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mouseover</span><span class="op">:</span> highlightFeature<span class="op">,</span></span>
<span id="cb14-373"><a href="#cb14-373" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mouseout</span><span class="op">:</span> resetHighlight</span>
<span id="cb14-374"><a href="#cb14-374" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb14-375"><a href="#cb14-375" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-376"><a href="#cb14-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-377"><a href="#cb14-377" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> DistLayer  <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJson</span>(nsw_shp_json<span class="op">,</span> </span>
<span id="cb14-378"><a href="#cb14-378" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb14-379"><a href="#cb14-379" aria-hidden="true" tabindex="-1"></a>      <span class="dt">filter</span><span class="op">:</span> districtFilter<span class="op">,</span></span>
<span id="cb14-380"><a href="#cb14-380" aria-hidden="true" tabindex="-1"></a>      <span class="dt">weight</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> </span>
<span id="cb14-381"><a href="#cb14-381" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">"#cc00007f"</span><span class="op">,</span></span>
<span id="cb14-382"><a href="#cb14-382" aria-hidden="true" tabindex="-1"></a>    })<span class="op">.</span><span class="fu">bindPopup</span>(<span class="kw">function</span> (Layer) {</span>
<span id="cb14-383"><a href="#cb14-383" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Layer<span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">districtna</span><span class="op">;</span></span>
<span id="cb14-384"><a href="#cb14-384" aria-hidden="true" tabindex="-1"></a>    })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb14-385"><a href="#cb14-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-386"><a href="#cb14-386" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> poaLayer <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJson</span>(poa_shp_json<span class="op">,</span></span>
<span id="cb14-387"><a href="#cb14-387" aria-hidden="true" tabindex="-1"></a>   {</span>
<span id="cb14-388"><a href="#cb14-388" aria-hidden="true" tabindex="-1"></a>      <span class="dt">filter</span><span class="op">:</span> postCodeFilter<span class="op">,</span></span>
<span id="cb14-389"><a href="#cb14-389" aria-hidden="true" tabindex="-1"></a>      <span class="dt">style</span> <span class="op">:</span> style<span class="op">,</span></span>
<span id="cb14-390"><a href="#cb14-390" aria-hidden="true" tabindex="-1"></a>      <span class="dt">onEachFeature</span><span class="op">:</span> onEachFeature</span>
<span id="cb14-391"><a href="#cb14-391" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb14-392"><a href="#cb14-392" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb14-393"><a href="#cb14-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-394"><a href="#cb14-394" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">fitBounds</span>(DistLayer<span class="op">.</span><span class="fu">getBounds</span>())<span class="op">;</span></span>
<span id="cb14-395"><a href="#cb14-395" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</section>
<section id="write-to-file" class="level1">
<h1>Write to file</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(out,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data/district_postcode_counts.csv"</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>

</main> <!-- /main -->

<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"out = transpose(out_raw)\nviewof theDistrict = Inputs.select(out.map(d => d.district),\n    {\n      label: \"District: \",\n      sort: true,\n      unique: true\n    }\n  )\nout_small = out.filter(d => d.district == theDistrict)  \n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"Inputs.table(\n  out_small,\n  {\n   format: {\n    per_of_district: x => x.toFixed(1),\n    per_of_postcode: x => x.toFixed(1)\n  },\n  rows: out_small.length + 10\n  }\n)\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"nsw_shp_json = await FileAttachment(\"data/nsw_shp.json\").json()\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"width = 800\nheight = 650\npoa_shp_json = FileAttachment(\"data/nsw_poa_shp.json\").json()\n\nthePostcodes = out_small.map(d => d.postcode)\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"L = require('leaflet@1.9.2')\n\nmap2 = {\n  let container = DOM.element ('div', { style: `width:${width}px;height:${height}px` });\n  yield container;\n  \n  let map = L.map(container)\n  let osmLayer = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.{ext}', {\n      attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  subdomains: 'abcd',\n\tminZoom: 0,\n\tmaxZoom: 25,\n\text: 'png'\n  }).addTo(map);\n  \n  function districtFilter(feature) {\n    if(feature.properties.districtna === theDistrict) return true\n  }\n  \n  function postCodeFilter(feature) {\n    if(thePostcodes.includes(feature.properties.POA_CODE21)) return true;\n  }\n\n  function style(feature) {\n    return {\n        fillColor: \"blue\",\n        weight: 2,\n        opacity: 0.7,\n        color: 'blue',\n        fillOpacity: 0.0\n    };\n  }\n\n  // highlight function\n  function highlightFeature(e) {\n    var layer = e.target;\n\n    layer.setStyle({\n        fillOpacity: 0.5,\n        opacity: 1.0,\n        weight: 3\n    });\n    \n    layer.openTooltip();\n    \n    layer.bringToFront();\n  }\n\n  // mouseout\n  function resetHighlight(e) {\n    poaLayer.resetStyle(e.target);\n  }\n  \n  function onEachFeature(feature, layer) {\n    layer.bindTooltip(\"<div style='background:white; padding:1px 3px 1px 3px'><b>\" + feature.properties.POA_CODE21 + \"</b></div>\",\n                     {\n                        direction: 'right',\n                        permanent: false,\n                        sticky: true,\n                        offset: [10, 0],\n                        opacity: 1,\n                        className: 'leaflet-tooltip-own'\n                     });\n    layer.on({\n        mouseover: highlightFeature,\n        mouseout: resetHighlight\n    });\n  }\n\n  let DistLayer  = L.geoJson(nsw_shp_json, \n    {\n      filter: districtFilter,\n      weight: 5, \n      color: \"#cc00007f\",\n    }).bindPopup(function (Layer) {\n        return Layer.feature.properties.districtna;\n    }).addTo(map);\n\n  let poaLayer = L.geoJson(poa_shp_json,\n   {\n      filter: postCodeFilter,\n      style : style,\n      onEachFeature: onEachFeature\n    })\n    .addTo(map);\n\n  map.fitBounds(DistLayer.getBounds());\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('theDistrict')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "NSW 2023 legislative districts to postcodes: correspondence file &amp; mapping application"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">  We derive the correspondence between NSW legislative districts and postcodes via a spatial merge, using the G-NAF and a MapInfo file of district boundaries from the NSW Electoral Commission.  We also provide an interactive tabular summary and map of the correspondence.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Simon Jackman"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> now</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> "h:mmA D MMMM YYYY"</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">      - cosmo</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">      - custom.scss</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">    mainfont: Avenir</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 14px</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 8</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 6</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: true</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">    ##embed-resources: true</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">    ##standalone: true</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="an">tbl-cap-location:</span><span class="co"> bottom    </span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="an">crossref:</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">  tbl-title: Table</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span><span class="co"> </span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_knit: </span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: TRUE</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">    include: TRUE</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">    message: FALSE</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co">  keep-md: true</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fst)</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession,<span class="at">workers =</span> <span class="dv">8</span>)</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="fu"># Inputs</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="do">## run this once away from this script</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>nsw_shp_file <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="fu">here</span>(<span class="st">"aux_data/nsw"</span>),</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pattern =</span> <span class="st">"*.MID"</span>)</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>gnaf_core <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"aux_data/G-NAF/G-NAFCore_AUG22_AUSTRALIA_GDA2020_PSV_100/G-NAF Core/G-NAF Core AUGUST 2022/Standard/GNAF_CORE.psv"</span>)</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>Not included in this repo for size and/or license restrictions:</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NSW Electoral Commission <span class="co">[</span><span class="ot">MapInfo file</span><span class="co">](https://www.elections.nsw.gov.au/NSWEC/media/NSWEC/Maps/index-maps/StateElectoralDistrict2021_GDA2020.zip)</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>List of NSW addresses from the August 2022 G-NAF (the <span class="co">[</span><span class="ot">Geocoded National Address File</span><span class="co">](https://geoscape.com.au/data/g-naf-core/)</span>).</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>For making maps, we use the (very good) approximations to <span class="co">[</span><span class="ot">postcode geographies</span><span class="co">](https://www.abs.gov.au/statistics/standards/australian-statistical-geography-standard-asgs-edition-3/jul2021-jun2026/non-abs-structures/postal-areas)</span> provided in <span class="co">[</span><span class="ot">shapefiles</span><span class="co">](https://www.abs.gov.au/statistics/standards/australian-statistical-geography-standard-asgs-edition-3/jul2021-jun2026/access-and-downloads/digital-boundary-files/POA_2021_AUST_GDA94_SHP.zip)</span> published by the Australian Bureau of Statistics.</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a><span class="fu"># Methodology</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Every G-NAF address in NSW is geocoded using <span class="co">[</span><span class="ot">GDA94</span><span class="co">](https://epsg.io/4939)</span> or <span class="co">[</span><span class="ot">GDA 2020 CRS</span><span class="co">](https://epsg.io/7844)</span>, the same CRS used for both the NSW legislative district <span class="in">`MapInfo`</span> file and ABS postal area shape files.</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Locate each geo-coded NSW address from G-NAF in a NSW legislative district, using functions in the <span class="co">[</span><span class="ot">`sf` R package</span><span class="co">](https://journal.r-project.org/archive/2018/RJ-2018-009/RJ-2018-009.pdf)</span>.</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For each postcode, compute and report count and what proportion of its geo-coded addresses lie in each district.</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use <span class="co">[</span><span class="ot">`leaflet`</span><span class="co">](https://leafletjs.com "https://leafletjs.com")</span> to build a JS mapping/visualization application.</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">`quarto`</span><span class="co">](https://quarto.org)</span> assembles this document and the web application, in turn utilising <span class="co">[</span><span class="ot">`Observable JS`</span><span class="co">](https://observablehq.com/@observablehq/observables-not-javascript)</span> for table building and the call to <span class="in">`leaflet`</span> (@sec-interactive). </span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a><span class="fu"># Read G-NAF</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>gnaf <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> gnaf_core, <span class="at">delim =</span> <span class="st">"|"</span>)</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>nsw_addresses <span class="ot">&lt;-</span> gnaf <span class="sc">%&gt;%</span></span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"NSW"</span>)</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a><span class="fu">write.fst</span>(nsw_addresses, <span class="at">path =</span> <span class="fu">here</span>(<span class="st">"data/gnaf_subset.fst"</span>))</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gnaf)</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: false</span></span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nsw-gnaf-read</span></span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>nsw_addresses <span class="ot">&lt;-</span> <span class="fu">read.fst</span>(<span class="at">path =</span> <span class="fu">here</span>(<span class="st">"data/gnaf_subset.fst"</span>))</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_addresses <span class="sc">%&gt;%</span> </span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(postcode,longitude,latitude)</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(nsw_geo,</span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>                    <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">'longitude'</span>, <span class="st">'latitude'</span>),</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>                    <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>))</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>We subset the G-NAF "core" file to NSW addresses, yielding <span class="in">`r format(nrow(nsw_addresses),big.mark=",")`</span> addresses, spanning <span class="in">`r format(nsw_addresses %&gt;% distinct(postcode) %&gt;% nrow(),big.mark=",")`</span> postcodes and <span class="in">`r format(nsw_geo %&gt;% nrow(),big.mark=",")`</span> distinct geo-codes (latitude/longitude pairs).</span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a><span class="fu"># NSW state legislative districts</span></span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>We read the <span class="co">[</span><span class="ot">MapInfo file</span><span class="co">](https://www.elections.nsw.gov.au/NSWEC/media/NSWEC/Maps/index-maps/StateElectoralDistrict2021_GDA2020.zip)</span> supplied by the <span class="co">[</span><span class="ot">NSW Electoral Commission</span><span class="co">](https://www.elections.nsw.gov.au/redistribution/Final-boundaries-and-names)</span>; this employs the <span class="in">`GDA2020`</span> CRS and contain the boundaries for NSW's 93 electorate districts, to be used in the 2023 election (gazetted and proclaimed on 26 August 2021).</span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: false</span></span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nsw-shp-read</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a>nsw_shp <span class="ot">&lt;-</span></span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_read</span>(</span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">dsn =</span> <span class="fu">here</span>(<span class="st">"data/StateElectoralDistrict2021_GDA2020.MID"</span>),</span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">query =</span> <span class="fu">sprintf</span>(</span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a>      <span class="st">"SELECT objectid, cadid, districtna from StateElectoralDistrict2021_GDA2020"</span></span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a>nsw_shp <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(nsw_shp, <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>))</span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a>nsw_shp <span class="ot">&lt;-</span> <span class="fu">as</span>(nsw_shp, <span class="st">"sf"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_make_valid</span>() </span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a>geojsonio<span class="sc">::</span><span class="fu">geojson_write</span>(nsw_shp,<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data/nsw_shp.json"</span>))</span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a><span class="fu"># Read postcode shapefiles</span></span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a>For map-making later on, we read the ABS postal areas (postcode) shapefiles; the coordinates use the <span class="in">`GDA2020`</span> geodetic CRS, which corresponds to <span class="in">`EPSG:7843`</span> CRS used in the other data sets we utilize.</span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span></span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_read</span>(</span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">here</span>(<span class="st">"data/POA_2021_AUST_GDA2020_SHP/POA_2021_AUST_GDA2020.shp"</span>),</span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(poa_shp) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>)</span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(poa_shp, <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:7843"</span>))</span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span> <span class="fu">as</span>(poa_shp, <span class="st">"sf"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_make_valid</span>() </span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true" tabindex="-1"></a><span class="fu"># Matching addresses to districts</span></span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a>We now match the unique, geo-coded NSW addresses to districts, the real "work" of this exercise being done by the call to <span class="in">`sf::st_intersects`</span> in the function <span class="in">`pfunc`</span>; we group the data by <span class="in">`postcode`</span> and use processing these batches of data in parallel via <span class="in">`furrr::future_map`</span>.</span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: st-intersect-work</span></span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true" tabindex="-1"></a>pfunc <span class="ot">&lt;-</span> <span class="cf">function</span>(obj){</span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">st_intersects</span>(obj<span class="sc">$</span>geometry,nsw_shp)</span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(z))</span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_nest</span>(postcode) <span class="sc">%&gt;%</span> </span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">intersection =</span> <span class="fu">future_map</span>(<span class="at">.x =</span> data,</span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.f =</span> <span class="sc">~</span><span class="fu">pfunc</span>(.x))</span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data,intersection))</span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> nsw_shp<span class="sc">$</span>districtna[intersection])</span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true" tabindex="-1"></a>We merge the results back against the GNAF addresses for NSW:</span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-186"><a href="#cb16-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-187"><a href="#cb16-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: false</span></span>
<span id="cb16-188"><a href="#cb16-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: merge-back</span></span>
<span id="cb16-189"><a href="#cb16-189" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(nsw_geo<span class="sc">$</span>geometry)</span>
<span id="cb16-190"><a href="#cb16-190" aria-hidden="true" tabindex="-1"></a>nsw_geo <span class="ot">&lt;-</span> nsw_geo <span class="sc">%&gt;%</span> </span>
<span id="cb16-191"><a href="#cb16-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude =</span> coords[,<span class="dv">1</span>],</span>
<span id="cb16-192"><a href="#cb16-192" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude =</span> coords[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb16-193"><a href="#cb16-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>geometry) </span>
<span id="cb16-194"><a href="#cb16-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-195"><a href="#cb16-195" aria-hidden="true" tabindex="-1"></a>nsw_addresses <span class="ot">&lt;-</span> <span class="fu">left_join</span>(nsw_addresses,</span>
<span id="cb16-196"><a href="#cb16-196" aria-hidden="true" tabindex="-1"></a>                           nsw_geo,</span>
<span id="cb16-197"><a href="#cb16-197" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"postcode"</span>, <span class="st">"longitude"</span>, <span class="st">"latitude"</span>))</span>
<span id="cb16-198"><a href="#cb16-198" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(nsw_geo,coords)</span>
<span id="cb16-199"><a href="#cb16-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-200"><a href="#cb16-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-201"><a href="#cb16-201" aria-hidden="true" tabindex="-1"></a>We also filter down to the subset of Australian postcodes that intersect NSW legislative districts:</span>
<span id="cb16-202"><a href="#cb16-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-205"><a href="#cb16-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-206"><a href="#cb16-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb16-207"><a href="#cb16-207" aria-hidden="true" tabindex="-1"></a>poa_shp <span class="ot">&lt;-</span> poa_shp <span class="sc">%&gt;%</span> </span>
<span id="cb16-208"><a href="#cb16-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(nsw_addresses <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(postcode),</span>
<span id="cb16-209"><a href="#cb16-209" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"POA_CODE21"</span> <span class="ot">=</span> <span class="st">"postcode"</span>)) </span>
<span id="cb16-210"><a href="#cb16-210" aria-hidden="true" tabindex="-1"></a>poa_shp_small <span class="ot">&lt;-</span> poa_shp <span class="sc">%&gt;%</span> </span>
<span id="cb16-211"><a href="#cb16-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_simplify</span>(<span class="at">preserveTopology =</span> <span class="cn">TRUE</span>, <span class="at">dTolerance =</span> <span class="dv">5</span>)</span>
<span id="cb16-212"><a href="#cb16-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-213"><a href="#cb16-213" aria-hidden="true" tabindex="-1"></a>geojsonio<span class="sc">::</span><span class="fu">geojson_write</span>(poa_shp_small,<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data/nsw_poa_shp.json"</span>))</span>
<span id="cb16-214"><a href="#cb16-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-215"><a href="#cb16-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-216"><a href="#cb16-216" aria-hidden="true" tabindex="-1"></a><span class="fu"># Counts of addresses by legislative district</span></span>
<span id="cb16-217"><a href="#cb16-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-218"><a href="#cb16-218" aria-hidden="true" tabindex="-1"></a>We compute counts of addresses with postcodes within districts; we also compute</span>
<span id="cb16-219"><a href="#cb16-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-220"><a href="#cb16-220" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>percentage of a district's addresses in a given postcode (<span class="in">`per_of_district`</span>)</span>
<span id="cb16-221"><a href="#cb16-221" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>percentage of a postcode's addresses in a given district (<span class="in">`per_of_postcode`</span>)</span>
<span id="cb16-222"><a href="#cb16-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-225"><a href="#cb16-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-226"><a href="#cb16-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: count-addresses</span></span>
<span id="cb16-227"><a href="#cb16-227" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> nsw_addresses <span class="sc">%&gt;%</span> </span>
<span id="cb16-228"><a href="#cb16-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(district,postcode) <span class="sc">%&gt;%</span> </span>
<span id="cb16-229"><a href="#cb16-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(district) <span class="sc">%&gt;%</span> </span>
<span id="cb16-230"><a href="#cb16-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">per_of_district =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-231"><a href="#cb16-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-232"><a href="#cb16-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(postcode) <span class="sc">%&gt;%</span> </span>
<span id="cb16-233"><a href="#cb16-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">per_of_postcode =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-234"><a href="#cb16-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-235"><a href="#cb16-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(district,<span class="fu">desc</span>(per_of_district))</span>
<span id="cb16-236"><a href="#cb16-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-237"><a href="#cb16-237" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(nsw_addresses)</span>
<span id="cb16-238"><a href="#cb16-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-239"><a href="#cb16-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-242"><a href="#cb16-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-243"><a href="#cb16-243" aria-hidden="true" tabindex="-1"></a><span class="fu">ojs_define</span>(<span class="at">out_raw=</span>out)</span>
<span id="cb16-244"><a href="#cb16-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb16-245"><a href="#cb16-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-246"><a href="#cb16-246" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linked table and map {#sec-interactive}</span></span>
<span id="cb16-247"><a href="#cb16-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-250"><a href="#cb16-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb16-251"><a href="#cb16-251" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> <span class="fu">transpose</span>(out_raw)</span>
<span id="cb16-252"><a href="#cb16-252" aria-hidden="true" tabindex="-1"></a>viewof theDistrict <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(out<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">district</span>)<span class="op">,</span></span>
<span id="cb16-253"><a href="#cb16-253" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb16-254"><a href="#cb16-254" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"District: "</span><span class="op">,</span></span>
<span id="cb16-255"><a href="#cb16-255" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sort</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb16-256"><a href="#cb16-256" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unique</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb16-257"><a href="#cb16-257" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-258"><a href="#cb16-258" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-259"><a href="#cb16-259" aria-hidden="true" tabindex="-1"></a>out_small <span class="op">=</span> out<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">district</span> <span class="op">==</span> theDistrict)  </span>
<span id="cb16-260"><a href="#cb16-260" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb16-261"><a href="#cb16-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-264"><a href="#cb16-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb16-265"><a href="#cb16-265" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(</span>
<span id="cb16-266"><a href="#cb16-266" aria-hidden="true" tabindex="-1"></a>  out_small<span class="op">,</span></span>
<span id="cb16-267"><a href="#cb16-267" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-268"><a href="#cb16-268" aria-hidden="true" tabindex="-1"></a>   <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb16-269"><a href="#cb16-269" aria-hidden="true" tabindex="-1"></a>    <span class="dt">per_of_district</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb16-270"><a href="#cb16-270" aria-hidden="true" tabindex="-1"></a>    <span class="dt">per_of_postcode</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)</span>
<span id="cb16-271"><a href="#cb16-271" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb16-272"><a href="#cb16-272" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rows</span><span class="op">:</span> out_small<span class="op">.</span><span class="at">length</span> <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb16-273"><a href="#cb16-273" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-274"><a href="#cb16-274" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-275"><a href="#cb16-275" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb16-276"><a href="#cb16-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-277"><a href="#cb16-277" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span>{<span class="op">=</span>html}</span>
<span id="cb16-278"><a href="#cb16-278" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>link rel<span class="op">=</span><span class="st">"stylesheet"</span> href<span class="op">=</span><span class="st">"https://unpkg.com/leaflet@1.9.2/dist/leaflet.css"</span></span>
<span id="cb16-279"><a href="#cb16-279" aria-hidden="true" tabindex="-1"></a>     integrity<span class="op">=</span><span class="st">"sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14="</span></span>
<span id="cb16-280"><a href="#cb16-280" aria-hidden="true" tabindex="-1"></a>     crossorigin<span class="op">=</span><span class="st">""</span><span class="op">/&gt;</span></span>
<span id="cb16-281"><a href="#cb16-281" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>script src<span class="op">=</span><span class="st">"https://unpkg.com/leaflet@1.9.2/dist/leaflet.js"</span></span>
<span id="cb16-282"><a href="#cb16-282" aria-hidden="true" tabindex="-1"></a>     integrity<span class="op">=</span><span class="st">"sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg="</span></span>
<span id="cb16-283"><a href="#cb16-283" aria-hidden="true" tabindex="-1"></a>     crossorigin<span class="op">=</span><span class="st">""</span><span class="op">&gt;&lt;/</span>script<span class="op">&gt;</span></span>
<span id="cb16-284"><a href="#cb16-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>style<span class="op">&gt;</span></span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="at">leaflet</span><span class="op">-</span>container {</span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a>      font<span class="op">-</span><span class="dt">family</span><span class="op">:</span> <span class="st">"Avenir"</span><span class="op">,</span> <span class="st">"Helvetica Neue"</span><span class="op">,</span> Arial<span class="op">,</span> Helvetica<span class="op">,</span> sans<span class="op">-</span>serif<span class="op">;</span></span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a>      font<span class="op">-</span><span class="dt">size</span><span class="op">:</span> <span class="dv">12</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a>      font<span class="op">-</span><span class="dt">size</span><span class="op">:</span> <span class="fl">0.75</span>rem<span class="op">;</span></span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a>      line<span class="op">-</span><span class="dt">height</span><span class="op">:</span> <span class="fl">1.5</span><span class="op">;</span></span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="at">leaflet</span><span class="op">-</span>tooltip<span class="op">-</span>left<span class="op">:</span>before {</span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a>    <span class="dt">right</span><span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-295"><a href="#cb16-295" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">-</span><span class="dt">right</span><span class="op">:</span> <span class="op">-</span><span class="dv">12</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb16-296"><a href="#cb16-296" aria-hidden="true" tabindex="-1"></a>    border<span class="op">-</span><span class="dt">left</span><span class="op">:</span> <span class="dv">0</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a>    border<span class="op">-</span>left<span class="op">-</span><span class="dt">color</span><span class="op">:</span> <span class="fu">rgba</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="at">leaflet</span><span class="op">-</span>tooltip<span class="op">-</span>right<span class="op">:</span>before {</span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a>    <span class="dt">left</span><span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">-</span><span class="dt">left</span><span class="op">:</span> <span class="op">-</span><span class="dv">12</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a>    border<span class="op">-</span><span class="dt">right</span><span class="op">:</span> <span class="dv">0</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a>    border<span class="op">-</span>right<span class="op">-</span><span class="dt">color</span><span class="op">:</span> <span class="fu">rgba</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="at">leaflet</span><span class="op">-</span>tooltip<span class="op">-</span>own {</span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a>    <span class="dt">position</span><span class="op">:</span> absolute<span class="op">;</span></span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a>    <span class="dt">padding</span><span class="op">:</span> <span class="dv">4</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a>    background<span class="op">-</span><span class="dt">color</span><span class="op">:</span> <span class="fu">rgba</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a>    <span class="dt">border</span><span class="op">:</span> <span class="dv">0</span><span class="er">px</span> solid #<span class="dv">000</span><span class="op">;</span></span>
<span id="cb16-310"><a href="#cb16-310" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> #<span class="dv">000</span><span class="op">;</span></span>
<span id="cb16-311"><a href="#cb16-311" aria-hidden="true" tabindex="-1"></a>    white<span class="op">-</span><span class="dt">space</span><span class="op">:</span> nowrap<span class="op">;</span></span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span>webkit<span class="op">-</span>user<span class="op">-</span><span class="dt">select</span><span class="op">:</span> none<span class="op">;</span></span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span>moz<span class="op">-</span>user<span class="op">-</span><span class="dt">select</span><span class="op">:</span> none<span class="op">;</span></span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span>ms<span class="op">-</span>user<span class="op">-</span><span class="dt">select</span><span class="op">:</span> none<span class="op">;</span></span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a>    user<span class="op">-</span><span class="dt">select</span><span class="op">:</span> none<span class="op">;</span></span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a>    pointer<span class="op">-</span><span class="dt">events</span><span class="op">:</span> none<span class="op">;</span></span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a>    box<span class="op">-</span><span class="dt">shadow</span><span class="op">:</span> <span class="dv">0</span> <span class="dv">1</span><span class="er">px</span> <span class="dv">3</span><span class="er">px</span> <span class="fu">rgba</span>(<span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="fl">0.4</span>)<span class="op">;</span></span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;/</span>style<span class="op">&gt;</span>     </span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>nsw_shp_json <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"data/nsw_shp.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="dv">800</span></span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="dv">650</span></span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a>poa_shp_json <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data/nsw_poa_shp.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a>thePostcodes <span class="op">=</span> out_small<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">postcode</span>)</span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-339"><a href="#cb16-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb16-340"><a href="#cb16-340" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="pp">require</span>(<span class="st">'leaflet@1.9.2'</span>)</span>
<span id="cb16-341"><a href="#cb16-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-342"><a href="#cb16-342" aria-hidden="true" tabindex="-1"></a>map2 <span class="op">=</span> {</span>
<span id="cb16-343"><a href="#cb16-343" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> container <span class="op">=</span> DOM<span class="op">.</span><span class="fu">element</span> (<span class="st">'div'</span><span class="op">,</span> { <span class="dt">style</span><span class="op">:</span> <span class="vs">`width:</span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px;height:</span><span class="sc">${</span>height<span class="sc">}</span><span class="vs">px`</span> })<span class="op">;</span></span>
<span id="cb16-344"><a href="#cb16-344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> container<span class="op">;</span></span>
<span id="cb16-345"><a href="#cb16-345" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-346"><a href="#cb16-346" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> map <span class="op">=</span> L<span class="op">.</span><span class="fu">map</span>(container)</span>
<span id="cb16-347"><a href="#cb16-347" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> osmLayer <span class="op">=</span> L<span class="op">.</span><span class="fu">tileLayer</span>(<span class="st">'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.{ext}'</span><span class="op">,</span> {</span>
<span id="cb16-348"><a href="#cb16-348" aria-hidden="true" tabindex="-1"></a>      <span class="dt">attribution</span><span class="op">:</span> <span class="st">'Map tiles by &lt;a href="http://stamen.com"&gt;Stamen Design&lt;/a&gt;, &lt;a href="http://creativecommons.org/licenses/by/3.0"&gt;CC BY 3.0&lt;/a&gt; &amp;mdash; Map data &amp;copy; &lt;a href="https://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors'</span><span class="op">,</span></span>
<span id="cb16-349"><a href="#cb16-349" aria-hidden="true" tabindex="-1"></a>  <span class="dt">subdomains</span><span class="op">:</span> <span class="st">'abcd'</span><span class="op">,</span></span>
<span id="cb16-350"><a href="#cb16-350" aria-hidden="true" tabindex="-1"></a>    <span class="dt">minZoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb16-351"><a href="#cb16-351" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxZoom</span><span class="op">:</span> <span class="dv">25</span><span class="op">,</span></span>
<span id="cb16-352"><a href="#cb16-352" aria-hidden="true" tabindex="-1"></a>    <span class="dt">ext</span><span class="op">:</span> <span class="st">'png'</span></span>
<span id="cb16-353"><a href="#cb16-353" aria-hidden="true" tabindex="-1"></a>  })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb16-354"><a href="#cb16-354" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-355"><a href="#cb16-355" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">districtFilter</span>(feature) {</span>
<span id="cb16-356"><a href="#cb16-356" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">districtna</span> <span class="op">===</span> theDistrict) <span class="cf">return</span> <span class="kw">true</span></span>
<span id="cb16-357"><a href="#cb16-357" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-358"><a href="#cb16-358" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-359"><a href="#cb16-359" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">postCodeFilter</span>(feature) {</span>
<span id="cb16-360"><a href="#cb16-360" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(thePostcodes<span class="op">.</span><span class="fu">includes</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">POA_CODE21</span>)) <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb16-361"><a href="#cb16-361" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-362"><a href="#cb16-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-363"><a href="#cb16-363" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">style</span>(feature) {</span>
<span id="cb16-364"><a href="#cb16-364" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb16-365"><a href="#cb16-365" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillColor</span><span class="op">:</span> <span class="st">"blue"</span><span class="op">,</span></span>
<span id="cb16-366"><a href="#cb16-366" aria-hidden="true" tabindex="-1"></a>        <span class="dt">weight</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb16-367"><a href="#cb16-367" aria-hidden="true" tabindex="-1"></a>        <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb16-368"><a href="#cb16-368" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">'blue'</span><span class="op">,</span></span>
<span id="cb16-369"><a href="#cb16-369" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.0</span></span>
<span id="cb16-370"><a href="#cb16-370" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb16-371"><a href="#cb16-371" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-372"><a href="#cb16-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-373"><a href="#cb16-373" aria-hidden="true" tabindex="-1"></a>  <span class="co">// highlight function</span></span>
<span id="cb16-374"><a href="#cb16-374" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">highlightFeature</span>(e) {</span>
<span id="cb16-375"><a href="#cb16-375" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> layer <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb16-376"><a href="#cb16-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-377"><a href="#cb16-377" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">setStyle</span>({</span>
<span id="cb16-378"><a href="#cb16-378" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb16-379"><a href="#cb16-379" aria-hidden="true" tabindex="-1"></a>        <span class="dt">opacity</span><span class="op">:</span> <span class="fl">1.0</span><span class="op">,</span></span>
<span id="cb16-380"><a href="#cb16-380" aria-hidden="true" tabindex="-1"></a>        <span class="dt">weight</span><span class="op">:</span> <span class="dv">3</span></span>
<span id="cb16-381"><a href="#cb16-381" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb16-382"><a href="#cb16-382" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-383"><a href="#cb16-383" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">openTooltip</span>()<span class="op">;</span></span>
<span id="cb16-384"><a href="#cb16-384" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-385"><a href="#cb16-385" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">bringToFront</span>()<span class="op">;</span></span>
<span id="cb16-386"><a href="#cb16-386" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-387"><a href="#cb16-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-388"><a href="#cb16-388" aria-hidden="true" tabindex="-1"></a>  <span class="co">// mouseout</span></span>
<span id="cb16-389"><a href="#cb16-389" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">resetHighlight</span>(e) {</span>
<span id="cb16-390"><a href="#cb16-390" aria-hidden="true" tabindex="-1"></a>    poaLayer<span class="op">.</span><span class="fu">resetStyle</span>(e<span class="op">.</span><span class="at">target</span>)<span class="op">;</span></span>
<span id="cb16-391"><a href="#cb16-391" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-392"><a href="#cb16-392" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-393"><a href="#cb16-393" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">onEachFeature</span>(feature<span class="op">,</span> layer) {</span>
<span id="cb16-394"><a href="#cb16-394" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">bindTooltip</span>(<span class="st">"&lt;div style='background:white; padding:1px 3px 1px 3px'&gt;&lt;b&gt;"</span> <span class="op">+</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">POA_CODE21</span> <span class="op">+</span> <span class="st">"&lt;/b&gt;&lt;/div&gt;"</span><span class="op">,</span></span>
<span id="cb16-395"><a href="#cb16-395" aria-hidden="true" tabindex="-1"></a>                     {</span>
<span id="cb16-396"><a href="#cb16-396" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">direction</span><span class="op">:</span> <span class="st">'right'</span><span class="op">,</span></span>
<span id="cb16-397"><a href="#cb16-397" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">permanent</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb16-398"><a href="#cb16-398" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">sticky</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb16-399"><a href="#cb16-399" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">offset</span><span class="op">:</span> [<span class="dv">10</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb16-400"><a href="#cb16-400" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb16-401"><a href="#cb16-401" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">className</span><span class="op">:</span> <span class="st">'leaflet-tooltip-own'</span></span>
<span id="cb16-402"><a href="#cb16-402" aria-hidden="true" tabindex="-1"></a>                     })<span class="op">;</span></span>
<span id="cb16-403"><a href="#cb16-403" aria-hidden="true" tabindex="-1"></a>    layer<span class="op">.</span><span class="fu">on</span>({</span>
<span id="cb16-404"><a href="#cb16-404" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mouseover</span><span class="op">:</span> highlightFeature<span class="op">,</span></span>
<span id="cb16-405"><a href="#cb16-405" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mouseout</span><span class="op">:</span> resetHighlight</span>
<span id="cb16-406"><a href="#cb16-406" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb16-407"><a href="#cb16-407" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-408"><a href="#cb16-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-409"><a href="#cb16-409" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> DistLayer  <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJson</span>(nsw_shp_json<span class="op">,</span> </span>
<span id="cb16-410"><a href="#cb16-410" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb16-411"><a href="#cb16-411" aria-hidden="true" tabindex="-1"></a>      <span class="dt">filter</span><span class="op">:</span> districtFilter<span class="op">,</span></span>
<span id="cb16-412"><a href="#cb16-412" aria-hidden="true" tabindex="-1"></a>      <span class="dt">weight</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> </span>
<span id="cb16-413"><a href="#cb16-413" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">"#cc00007f"</span><span class="op">,</span></span>
<span id="cb16-414"><a href="#cb16-414" aria-hidden="true" tabindex="-1"></a>    })<span class="op">.</span><span class="fu">bindPopup</span>(<span class="kw">function</span> (Layer) {</span>
<span id="cb16-415"><a href="#cb16-415" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Layer<span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">districtna</span><span class="op">;</span></span>
<span id="cb16-416"><a href="#cb16-416" aria-hidden="true" tabindex="-1"></a>    })<span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb16-417"><a href="#cb16-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-418"><a href="#cb16-418" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> poaLayer <span class="op">=</span> L<span class="op">.</span><span class="fu">geoJson</span>(poa_shp_json<span class="op">,</span></span>
<span id="cb16-419"><a href="#cb16-419" aria-hidden="true" tabindex="-1"></a>   {</span>
<span id="cb16-420"><a href="#cb16-420" aria-hidden="true" tabindex="-1"></a>      <span class="dt">filter</span><span class="op">:</span> postCodeFilter<span class="op">,</span></span>
<span id="cb16-421"><a href="#cb16-421" aria-hidden="true" tabindex="-1"></a>      <span class="dt">style</span> <span class="op">:</span> style<span class="op">,</span></span>
<span id="cb16-422"><a href="#cb16-422" aria-hidden="true" tabindex="-1"></a>      <span class="dt">onEachFeature</span><span class="op">:</span> onEachFeature</span>
<span id="cb16-423"><a href="#cb16-423" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb16-424"><a href="#cb16-424" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb16-425"><a href="#cb16-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-426"><a href="#cb16-426" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">fitBounds</span>(DistLayer<span class="op">.</span><span class="fu">getBounds</span>())<span class="op">;</span></span>
<span id="cb16-427"><a href="#cb16-427" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-428"><a href="#cb16-428" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
<span id="cb16-429"><a href="#cb16-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-430"><a href="#cb16-430" aria-hidden="true" tabindex="-1"></a><span class="vs"># Write to file</span></span>
<span id="cb16-431"><a href="#cb16-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-434"><a href="#cb16-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb16-435"><a href="#cb16-435" aria-hidden="true" tabindex="-1"></a>#<span class="op">|</span> eval<span class="op">:</span> <span class="kw">true</span></span>
<span id="cb16-436"><a href="#cb16-436" aria-hidden="true" tabindex="-1"></a>write<span class="op">.</span><span class="fu">csv</span>(out<span class="op">,</span></span>
<span id="cb16-437"><a href="#cb16-437" aria-hidden="true" tabindex="-1"></a>          file <span class="op">=</span> <span class="fu">here</span>(<span class="st">"data/district_postcode_counts.csv"</span>)<span class="op">,</span></span>
<span id="cb16-438"><a href="#cb16-438" aria-hidden="true" tabindex="-1"></a>          row<span class="op">.</span><span class="at">names</span> <span class="op">=</span> FALSE)</span>
<span id="cb16-439"><a href="#cb16-439" aria-hidden="true" tabindex="-1"></a><span class="vs">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>